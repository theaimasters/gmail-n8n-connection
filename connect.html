<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connect Your Gmail</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    max-width: 500px; 
    margin: 50px auto; 
    padding: 20px;
  }
  label { 
    display: block; 
    margin-top: 15px; 
    font-weight: bold; 
  }
  input, select { 
    width: 100%; 
    padding: 10px; 
    margin-top: 5px; 
    box-sizing: border-box;
  }
  button {
    margin-top: 25px; 
    padding: 12px; 
    width: 100%;
    background: #4285F4; 
    color: white; 
    border: none; 
    border-radius: 4px;
    font-size: 18px; 
    cursor: pointer;
  }
  button:hover {
    background: #357ae8;
  }
</style>
</head>
<body>
<h1>Connect Your Gmail</h1>
<p>Please fill out the information below and choose how much access you want to grant.</p>

<label>Full Name</label>
<input id="fullname" type="text" placeholder="John Doe" required>

<label>Company Name</label>
<input id="company" type="text" placeholder="Acme Corp" required>

<label>Choose Access Level</label>
<select id="scope">
  <option value="https://www.googleapis.com/auth/gmail.readonly">
    Basic reading (read-only)
  </option>
  <option value="https://www.googleapis.com/auth/gmail.modify https://www.googleapis.com/auth/gmail.send">
    Full read + send emails
  </option>
  <option value="https://mail.google.com/">
    Full access to Gmail
  </option>
</select>

<button onclick="connectGmail()">Connect with Google</button>

<script>
function connectGmail() {
  const fullname = document.getElementById('fullname').value.trim();
  const company = document.getElementById('company').value.trim();
  const scope = document.getElementById('scope').value;
  
  if (!fullname || !company) {
    alert("Please fill in your name and company.");
    return;
  }
  
  const rawState = JSON.stringify({ 
    cid: "UEwqJ7Vv1srVQRXL"
  });
  
  const state = btoa(rawState).replace(/=/g, '');
  
  const authUrl = "https://accounts.google.com/o/oauth2/v2/auth" +
    "?client_id=139836157120-v0cb002ub2gvq0q50mca0568h9q8abtj.apps.googleusercontent.com" +
    "&redirect_uri=" + encodeURIComponent("https://n8nscalera.eu/rest/oauth2-credential/callback") +
    "&response_type=code" +
    "&access_type=offline" +
    "&prompt=consent" +
    "&scope=" + encodeURIComponent(scope) +
    "&state=" + state;
  
  console.log("State (no padding):", state);
  window.location.href = authUrl;
}
</script>
</body>
</html>
